# Redis的数据类型

> Redis的单个操作都是原子性的。

## 供用户使用的数据类型

- **String：最基本的数据类型，二进制安全**
  - k-v键值对最大能存储521MB
  - 二进制安全的意思是Redis的String可以包含任何数据。eg:jpg图片，或者序列化的对象
  - 底层实现`sdshdr`
  

```c
/*
 *保存字符串对象的结构
 */
 struct sdshdr {
 
 	//buf 中已占用的空间长度
 	int len;
 	
 	//buf 中剩余可用空间的长度
 	int free
 	
 	//数据空间
 	char buf[];
 };
```

- **Hash: String元素组成的字典，适合用于存储对象（`field(String)-v`映射表）**

  - 优点类似于类对象，有属性通过get跟set访问修改属性。服务端序列化成Json的格式然后存储在其中。

- **List ：列表，按照String元素插入顺序排序**

  - 可以对List进行头插也可以进行尾插 
  - `lpush（头插）`，`lrange（从左开始顺序取）` == Stack（结构类似）

- **Set：String元素组成的无序集合，通过哈西表实现，不允许重复**

  - `sadd添加 key value`由于唯一性正确返回1，重复添加返回0。第二次插入的元素直接被忽略。
  - `smembers key value` 查看set集合中的元素
  - 应用场景：微博中将一个用户的所有关注的人和粉丝分别存储在两个集合中，利用Redis的求交集并集操作可以非常方便的实现如：共同关注共同喜好互关等功能，还可以将结果返回给客户端还是存储在新的集合之中。
  - 如果想要有序排列则需要使用Sorted Set数据类型

- **Sorted Set:通过分数来为集合中的成员进行从小到大的排序**

  - 与Set集合相同点：都是String类型的集合，且不允许重复的成员
  - **与Set集合不同点：每个元素都会关联一个Doublue类型的分数（Score），Redis正是通过整个分数来为集合中的成员进行排序**
  - ZSet集合中的每个成员的分数是可以重复的(重复的意思成员的`Score相同`但是成员的value不相同)
  - `zrangebyscore myzaet 0 10 `Set依据score范围排序查看

  - 应用：给全班的同学成绩进行排序则创建一个sort set value是每一位同学姓名，score是每一位同学分数。最后进行`zrangebyscore`排序即可。
  - 还可以用带score的set做带权重的队列按权重大小获取队列中的任务，重要任务优先执行。（优先级队列）

- **用于计数的HyperLogLog,用于支持存储地理位置信息的Geo**

## 底层数据类型基础

1. 简单动态字符串
2. 链表
3. 字典
4. 跳跃表
5. 整数集合
6. 压缩列表
7. 对象

